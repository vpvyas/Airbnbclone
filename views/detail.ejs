<% layout("layouts/heading.ejs") %>
<br><br>
  <div class="contentstyle">
    <div class="contents">
      <h3 class="header"><%= datas.title %></h3>
      <img src="<%=datas.image.url%>" style="width:450px; height:300px; border-radius: 10px; margin-bottom: 10px;">
      <p><strong>Description:</strong> <%= datas.description %></p>
      <p>
       <strong>Price</strong> &#8377;<%= datas.price?.toLocaleString("en-IN") || "N/A" %>/night
      </p>&nbsp;
      <p><strong>Location:</strong> <%= datas.location %></p>&nbsp;
      <p><strong>Country:</strong> <%= datas.country %></p>
      <div class="editbtn">  
        <form 
          action="/listing/<%= datas._id %>/del?_method=DELETE" 
          method="post"
          onsubmit="return confirm('Are you sure you want to delete?')">
          <button type="submit">Delete</button>
        </form>
        <form action="/listing/<%= datas._id %>/edit" method="get">
        <button type="submit">Edit</button>
        </form>
    </div>
  </div>
</div>
<div>
 <br><br>

<div class="review-wrapper">
  <div class="review-card">

    <h2 class="review-title">Add Review</h2>

    <form action="/listing/<%=datas._id%>/reviews" method="POST" class="review-form">

      <div class="form-group">
        <label for="message">Message</label>
        <textarea id="message" name="message" placeholder="Write your review..." required></textarea>
      </div>

      <div class="form-group">
        <label for="rating">Rating (1–5)</label>
        <input id="rating" type="number" name="rating" min="1" max="5" required>
      </div>

      <button type="submit" class="review-btn">Submit Review</button>

    </form>
  </div>
</div>

    <hr>

  
    <h2>All Reviews</h2>

<% if (datas.Reviews.length === 0) { %>
  <p>No reviews yet.</p>
<% } %>

<% datas.Reviews.forEach(r => { %>
  <div style="border-bottom:1px solid #ccc; margin-bottom:10px; padding:10px 0;">
    <p><%= r.message %></p>
    <p>⭐ <%= r.rating %> / 5</p>
    <small><%= new Date(r.createdAt).toLocaleString() %></small>
  </div>
<% }) %>


  </div>


</div>
<script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
  crossorigin="anonymous">
</script>
